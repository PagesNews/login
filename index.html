<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Salud Felina | Panleucopenia</title>

<!-- ================== ESTILOS ================== -->
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Segoe UI,Arial;
  background:#f4f7f6;
  color:#333;
}
header{
  background:#cfe8df;
  padding:60px 20px;
  text-align:center;
}
section{max-width:1100px;margin:auto;padding:40px 20px}
.card{
  background:#fff;
  padding:35px;
  margin-bottom:40px;
  border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.08)
}
.hidden{display:none}
input,button{
  width:100%;
  padding:14px;
  margin-top:10px;
  font-size:16px;
  border-radius:10px;
}
button{
  background:#6bb9a7;
  color:white;
  border:none;
  cursor:pointer;
}
button:hover{background:#5aa393}
.chat{
  border:1px solid #ccc;
  padding:15px;
  max-height:300px;
  overflow-y:auto;
  background:#fafafa;
}
.success{color:green}
.error{color:red}
</style>

<!-- ================== FIREBASE ================== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getAuth,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  GoogleAuthProvider,
  signInWithPopup,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import {
  getFirestore,
  collection,
  addDoc,
  serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "TU_PROYECTO.firebaseapp.com",
  projectId: "TU_PROYECTO"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* ================== AUTH ================== */
window.registrar = async ()=>{
  try{
    await createUserWithEmailAndPassword(auth,email.value,pass.value);
    msg.textContent="Registro exitoso";
    msg.className="success";
  }catch(e){msg.textContent=e.message;msg.className="error";}
}

window.login = async ()=>{
  try{
    await signInWithEmailAndPassword(auth,email.value,pass.value);
  }catch(e){msg.textContent=e.message;msg.className="error";}
}

window.loginGoogle = async ()=>{
  await signInWithPopup(auth,new GoogleAuthProvider());
}

/* ================== SESI칍N ================== */
onAuthStateChanged(auth,user=>{
  if(user){
    authBox.classList.add("hidden");
    contenido.classList.remove("hidden");
  }
});

/* ================== REGISTRO CAMPA칌A ================== */
window.registrarCampa침a = async ()=>{
  await addDoc(collection(db,"campaign_signups"),{
    email:auth.currentUser.email,
    createdAt:serverTimestamp()
  });
  alert("Correo guardado para campa침as");
}

/* ================== IA (LLAMA A BACKEND) ================== */
window.preguntarIA = async ()=>{
  const r = await fetch("https://TU_REGION-TU_PROYECTO.cloudfunctions.net/chatIA",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ prompt: pregunta.value })
  });
  const data = await r.json();
  chat.innerHTML += `<div><b>T칰:</b> ${pregunta.value}</div>`;
  chat.innerHTML += `<div><b>IA:</b> ${data.respuesta}</div>`;
  pregunta.value="";
};
</script>
</head>

<body>

<header>
<h1>Panleucopenia Felina 游냠</h1>
<p>Informaci칩n responsable, registro real y asistencia inteligente</p>
</header>

<section>

<div class="card" id="authBox">
<h2>Registro / Inicio de sesi칩n</h2>
<input id="email" placeholder="Correo">
<input id="pass" type="password" placeholder="Contrase침a">
<button onclick="registrar()">Registrarse</button>
<button onclick="login()">Iniciar sesi칩n</button>
<button onclick="loginGoogle()">Entrar con Google</button>
<p id="msg"></p>
</div>

<div class="card hidden" id="contenido">
<h2>Informaci칩n avanzada</h2>
<p>Contenido completo disponible solo para usuarios registrados.</p>
<button onclick="registrarCampa침a()">Recibir campa침as de vacunaci칩n</button>

<h3>Asistente IA</h3>
<div class="chat" id="chat"></div>
<input id="pregunta" placeholder="Pregunta sobre la enfermedad">
<button onclick="preguntarIA()">Preguntar</button>
</div>

</section>

</body>
</html>
